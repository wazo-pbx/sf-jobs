- nodeset:
    name: debian9-vm
    nodes:
      - label: debian9-vm
        name: test-node

- nodeset:
    name: runc-debian-buster
    nodes:
      - label: runc-debian-buster
        name: test-node

- nodeset:
    name: runc-debian-stretch
    nodes:
      - label: runc-debian-stretch
        name: test-node

- job:
    name: wazo-tox
    parent: tox
    description: |
      Run tox

      Like tox but
      * install sibling packages in virtualenv for Depends-On too
      * install sibling packages in docker compose environement for integration if enabled
        with docker_install_siblings
    run: playbooks/tox-wazo/run.yaml

- job:
    name: wazo-tox-integration
    parent: wazo-tox
    vars:
      docker_install_siblings: true
      tox_envlist: integration

- job:
    name: wazo-tox-py27
    parent: wazo-tox
    vars:
      tox_envlist: py27

- job:
    name: wazo-tox-py35
    parent: wazo-tox
    vars:
      tox_envlist: py35

- job:
    name: tox-py37
    parent: wazo-tox
    vars:
      tox_envlist: py37

- project-template:
    name: wazo-tox-py27
    description: Project template for tox -e py27
    check:
      jobs:
        - wazo-tox-py27:
            nodeset: runc-debian-stretch
    gate:
      jobs:
        - wazo-tox-py27:
            nodeset: runc-debian-stretch

- project-template:
    name: wazo-tox-py37
    description: Project template for tox -e py37
    check:
      jobs:
        - wazo-tox-py37:
            nodeset: runc-debian-stretch
    gate:
      jobs:
        - wazo-tox-py37:
            nodeset: runc-debian-stretch

- project-template:
    name: wazo-tox-py35
    description: Project template for tox -e py35
    check:
      jobs:
        - wazo-tox-py35:
            nodeset: runc-debian-stretch
    gate:
      jobs:
        - wazo-tox-py35:
            nodeset: runc-debian-stretch

- project-template:
    name: wazo-tox-linters
    description: Project template for tox -e linters
    check:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster
    gate:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster

- project-template:
    name: wazo-tox-integration
    description: Project template for tox -e integration
    check:
      jobs:
        - wazo-tox-integration:
            nodeset: debian9-vm
    gate:
      jobs:
        - wazo-tox-integration:
            nodeset: debian9-vm
