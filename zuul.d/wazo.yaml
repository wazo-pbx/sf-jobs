
- nodeset:
    name: debian9-vm
    nodes:
      - label: debian9-vm
        name: test-node

- nodeset:
    name: runc-debian-buster
    nodes:
      - label: runc-debian-buster
        name: test-node

- nodeset:
    name: runc-debian-stretch
    nodes:
      - label: runc-debian-stretch
        name: test-node

- job:
    name: tox-integration
    parent: tox
    description: |
      Run integration tests.

      Uses tox with the ``integration`` environment.
    run: playbooks/tox-integration/run.yaml
    vars:
      tox_envlist: integration
      docker_compose_services_override: []

- job:
    name: tox-integration-standalone
    parent: tox
    description: |
      Run integration tests.

      Uses tox with the ``integration`` environment.
    vars:
      tox_envlist: integration


- project-template:
    name: wazo-py35
    description: Project template for wazo python3 projects
    check:
      jobs:
        - tox-py35:
            nodeset: runc-debian-stretch
    gate:
      jobs:
        - tox-py35:
            nodeset: runc-debian-stretch
        - tox-integration:
            nodeset: debian9-vm

- project-template:
    name: wazo-linters
    description: Project template for wazo python3 projects
    check:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster
    gate:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster

- project-template:
    name: wazo-py27
    description: Project template for wazo python2 projects
    check:
      jobs:
        - tox-py27:
            nodeset: runc-debian-stretch
    gate:
      jobs:
        - tox-py27:
            nodeset: runc-debian-stretch

- project-template:
    name: wazo-integration
    description: Project template for wazo python2 projects
    check:
      jobs:
        - tox-integration:
            nodeset: debian9-vm
    gate:
      jobs:
        - tox-integration:
            nodeset: debian9-vm

- project-template:
    name: wazo-python3-standalone
    description: Project template for wazo python3 projects
    check:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster
        - tox-py35:
            nodeset: runc-debian-stretch
        - tox-integration-standalone:
            nodeset: debian9-vm
    gate:
      jobs:
        - tox-linters:
            nodeset: runc-debian-buster
        - tox-py35:
            nodeset: runc-debian-stretch
        - tox-integration-standalone:
            nodeset: debian9-vm
